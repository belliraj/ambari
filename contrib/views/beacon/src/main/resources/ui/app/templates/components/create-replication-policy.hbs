{{!
* Licensed to the Apache Software Foundation (ASF) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The ASF licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
}}
<div id="replication-policy" class="replication-policy-content">
	<div class="col-xs-12">
		Begin the replication process to initially copy the selected from the source cluster to the destination cluster
	</div>
	<ul id="create-policy" class="nav nav-tabs">
		<li class="active"><a data-target="#createTab" data-toggle="tab">1. Create Replication Policy</a></li>
		<li><a data-target="#reviewTab" data-toggle="tab">2. Review</a></li>
	</ul>
	<div class="tab-content">
		<div role="tabpanel" class="tab-pane active create-replication-policy-tab" id="createTab">
			<div class="panel panel-default">
				<div class="panel-body">
					<div class="row">
						<div class="col-xs-6">
							<label class="control-label smaller-font">POLICY NAME</label>
							{{input type="text" value=policy.name class="form-control width-forty-percent"}}
						</div>
						<div class="col-xs-6">
							<label class="control-label smaller-font">SERVICE</label>
							<div>
								<label class="radio-inline">
									<input type="radio" value="HIVE" checked={{if (eq policy.type 'HIVE') 'checked'}} onchange={{action "policyTypeChanged" value="target.value"}} name="replicationType">HIVE
								</label>
								<label class="radio-inline">
									<input type="radio" value="FS" checked={{if (eq policy.type 'FS') 'checked'}} onchange={{action "policyTypeChanged" value="target.value"}} name="replicationType">HDFS
								</label>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<label class="control-label smaller-font">SOURCE CLUSTER</label>
							<span class="form-control smaller-font">{{beaconSourceCluster.name}}>{{beaconSourceCluster.dataCenter}}</span>
						</div>
						<div class="col-xs-6">
							<label class="control-label smaller-font">DESTINATION CLUSTER</label>
							<select class="form-control width-forty-percent" onchange={{action (mut policy.targetCluster) value="target.value"}}>
								<option value="">Select</option>
								{{#each beaconSourceCluster.peersArray as |cluster|}}
								<option value="{{cluster.name}}">{{cluster.name}}</option>
								{{/each}}
							</select>
						</div>
					</div>
					{{#if (eq policy.type 'HIVE')}}
						<div class="row">
							<div class="col-xs-6">
								<label class="control-label smaller-font">SELECT DATABASES</label>
								<div>
									<label class="radio-inline">
										<input type="radio" name="databaseSelectionType" value='all' checked={{if (eq selectionType 'all') 'checked'}} onchange={{action 'onDBSelect' 'all'}}>All
									</label>
									<label class="radio-inline">
										<input type="radio" name="databaseSelectionType" value='selected' checked={{if (eq selectionType 'selected') 'checked'}} onchange={{action 'onDBSelect' 'selected'}}>Selection
									</label>
								</div>
									{{#if (eq selectionType 'selected')}}
									<div class="panel panel-body">
										{{#each hiveDatabases as |database|}}
										<div class="">
											<input type="checkbox" name="db-name" value={{database.name}}> &nbsp; {{database.name}}
										</div>
										{{/each}}
									</div>
									{{/if}}
									{{#if requestInProcess}}
										{{spin-spinner lines=7 length=5 radius=5 width=3 left=200}}
										<div class="hive-db-spinner-message">Fetching hive dbs..</div>
									{{/if}}
									{{#if hiveError}}
										<span class="text-danger">
											Could not fetch Hive DBs. <a href {{action "getHiveDbs" preventDefault=true}}>Try Again</a>
										</span>
									{{/if}}
							</div>
						</div>
					{{else}}
						<div class="row">
							<div class="col-xs-12">
								<label class="control-label smaller-font">ENTER PATH</label>
								<div class="input-group">
									{{input type=text class="form-control" value=policy.dataset}}
									<span class="input-group-btn">
										<button class="btn btn-primary" type="button" {{action "browse" 'policy.dataset'}}>Browse</button>
									</span>
    						</div>
							</div>
						</div>
					{{/if}}
					{{#if (gt volume  100)}}
						<div class="row">
							<div class="col-xs-12">
								<i class="fa fa-exclamation-triangle pr5"></i>Selected data volume is more than maximum allowed 100TB. Please select the databases you want to move.
							</div>
						</div>
					{{/if}}
				</div>
			</div>
			RUN JOB
			<div class="panel panel-default">
				<div class="panel-body">
					<div class="row hidden">
						<div class="col-xs-12">
							<div>
								<label class="radio-inline">
									<input type="radio" name="jobRun">Manually
								</label>
								<label class="radio-inline">
									<input type="radio" name="jobRun">On Schedule
								</label>
								<label class="radio-inline">
									<input type="radio" name="jobRun">On Data Modification
								</label>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12">
							<ul class="nav nav-tabs">
								<li {{action 'changeSchedule' 'hourly'}}><a data-target="#hourlyRun" data-toggle="tab">Hourly</a></li>
								<li {{action 'changeSchedule' 'daily'}} class="active"><a data-target="#dailyRun" data-toggle="tab">Daily</a></li>
								<li {{action 'changeSchedule' 'weekly'}}><a data-target="#weeklyRun" data-toggle="tab">Weekly</a></li>
								<li {{action 'changeSchedule' 'monthly'}}><a data-target="#monthlyRun" data-toggle="tab">Monthly</a></li>
								<li {{action 'changeSchedule' 'custom'}}><a data-target="#minuteRun" data-toggle="tab">Custom</a></li>
							</ul>
							<div class="tab-content">
								<div role="tabpanel" class="tab-pane" id="hourlyRun">
									Run Every Hour
								</div>
								<div role="tabpanel" class="tab-pane active" id="dailyRun">
									Run Every Day
								</div>
								<div role="tabpanel" class="tab-pane" id="weeklyRun">
									Run Every Week
								</div>
								<div role="tabpanel" class="tab-pane" id="monthlyRun">
									Run Every Month
								</div>
								<div role="tabpanel" class="tab-pane" id="minuteRun">
									Run Every {{input type=text value=customMinutes key-up=(action 'changeSchedule' 'custom')}} Minute
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div data-toggle="collapse" data-target="#advanced-panel" {{action "collapseHandler"}}>
				{{#if collapsed}}
					<i class="fa fa-chevron-down pull-left" aria-hidden="true"></i>
				{{else}}
					<i class="fa fa-chevron-right pull-left" aria-hidden="true"></i>
				{{/if}}
				ADVANCED PROPERTIES
			</div>
			{{#if (not collapsed)}}
			{{/if}}
			<div class="panel panel-default">
				<div id="advanced-panel" class="panel-body collapse">
					<div class="row">
						<div class="col-xs-4">
							<label class="control-label smaller-font">USER</label>
							{{input type="text" value=policy.aclOwner class="form-control"}}
						</div>
						<div class="col-xs-4">
							<label class="control-label smaller-font">GROUP</label>
							{{input type="text" value=policy.aclGroup class="form-control"}}
						</div>
						<div class="col-xs-4">
							<label class="control-label smaller-font">PERMISSION</label>
							{{input type="text" value=policy.aclPermission class="form-control"}}
						</div>
					</div>
					<div class="row">
						<div class="col-xs-4">
							<label class="control-label smaller-font">TAGS</label>
							{{input type="text" value=policy.tags class="form-control"}}
						</div>
					</div>
				</div>
			</div>
			<div class="clearfix">
				<button class="btn btn-default pull-right ml5 btn-action" role="button" {{action 'next'}}>GO TO REVIEW</button>
				<button class="btn btn-default pull-right" role="button" {{action 'cancel'}}>CANCEL</button>
			</div>
		</div>
		<div role="tabpanel" class="tab-pane review-tab" id="reviewTab">
			<div class="panel panel-default">
				<div class="panel-body">
					Data replication process for data selected from cluster <b>{{policy.sourceCluster}}</b> will be started.<br /><br />

					<!-- Transfer Details:<br />
					Total Data Volume:<br />
					Transfer Time:<br /> -->
					{{#if (eq policy.type 'HIVE')}}
						Databases: {{policy.dataset}}<br/>
					{{else}}
						Files: {{policy.dataset}}<br/>
					{{/if}}
					Destination: {{policy.targetCluster}} <br/>

					<i class="fa fa-exclamation-circle pr5"></i>The first run of the replication policy may take additional time.
				</div>
			</div>
			<div class="clearfix">
				<button class="btn btn-success pull-right ml5" role="button" {{action 'createPolicy'}}>SUBMIT</button>
				<button class="btn btn-default pull-right" role="button" {{action 'cancel'}}>CANCEL</button>
			</div>
		</div>
	</div>
	{{#if showingFileBrowser}}
	  {{hdfs-browser closeFileBrowser="closeFileBrowser" filePath=filePath}}
	{{/if}}
</div>
